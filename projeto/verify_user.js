document.addEventListener("DOMContentLoaded", function () {
  const loginForm = document.getElementById("form_login");
  const resultElement = document.getElementById("result");

  loginForm.addEventListener("submit", async function (event) {
    event.preventDefault();

    const formData = new FormData(loginForm);
    const username = formData.get("username");
    const password = formData.get("password");
    

    try {
      const response = await fetch("http://localhost:5050/login", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify({ username, password }),
      });

      console.log(response.status);

      if (response.status === 204) {
        resultElement.textContent = "Login successful!";
        window.location.href = "http://localhost:5050/login";
      } else if (response.ok) {
        const data = await response.json();
        resultElement.textContent = data.message;
      } else {
        const data = await response.json();
        resultElement.textContent = data.error || "Login failed. Please check your username and password.";
      }
      
    } catch (error) {
      console.error(error);
      resultElement.textContent = "An error occurred.";
    }
  });
});
